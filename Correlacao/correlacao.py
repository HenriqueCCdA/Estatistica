import math

# **********************************************************************
def posto(x):
    '''
    ********************************************************************
    data de criacao  : 06/05/2020
    data de modificao: 00/00/0000
    --------------------------------------------------------------------
    posto : Cacula o posto de x
    --------------------------------------------------------------------
    paremetros de enrada:
    --------------------------------------------------------------------
    x : valores
    --------------------------------------------------------------------
    retorno:
    --------------------------------------------------------------------
    posto_x : retorna o posto de x
    --------------------------------------------------------------------
    OBS:
    --------------------------------------------------------------------

    ********************************************************************
    '''
    posto_x = [0 for x in range(len(x))]
    for i in range(len(x)):
        (r, s) = (1, 1)
        for j in range(len(x)):
            # verifica quem Ã© menor que x[i]
            if j != i and x[j] < x[i]:
                r += 1
            # contar as repeticoes
            if j != i and x[j] == x[i]:
                s += 1
        # obter o posto
        posto_x[i] = r + (s - 1) / 2

    return posto_x
# **********************************************************************

# **********************************************************************
def corr(x, y, method='pearson'):
    '''
    ********************************************************************
    data de criacao  : 06/05/2020
    data de modificao: 00/00/0000
    --------------------------------------------------------------------
    posto : Cacula o posto de x
    --------------------------------------------------------------------
    paremetros de enrada:
    --------------------------------------------------------------------
    x : valores
    y : valores
    method : tipo da correlacao
            pearson
            spearman
    --------------------------------------------------------------------
    retorno:
    --------------------------------------------------------------------
    rho : valor de correlacao
    --------------------------------------------------------------------
    OBS:
    --------------------------------------------------------------------
    ********************************************************************
    '''

    def media(x):
        return sum(x)/len(x)

    nx = len(x)
    ny = len(y)

    if (nx!=ny):
        raise ValueError("Tamanho diferentes de arranjos!")

    # ...
    if(method == 'pearson'):
        x_bar = media(x)
        y_bar = media(y)

        num = 0.0e0
        den1= 0.0e0
        den2= 0.0e0

        for xi, yi in zip(x,y):
            dx  = (xi-x_bar)
            dy  = (yi-y_bar)
            num += dx*dy
            den1+= dx**2
            den2+= dy**2

        rho = num/(math.sqrt(den1*den2))
    # .................................................

    # ...
    elif(method == 'spearman'):
        posto_x = posto(x)
        posto_y = posto(y)
        rho = corr(posto_x, posto_y, 'pearson')
    # .................................................

    return rho
# **********************************************************************
